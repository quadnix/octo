<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport" >
    <title><%= title %></title>

    <!-- JSON Diff Patch via CDN stylesheets. -->
    <link
      href="https://esm.sh/jsondiffpatch@0.6.0/lib/formatters/styles/html.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="https://esm.sh/jsondiffpatch@0.6.0/lib/formatters/styles/annotated.css"
      rel="stylesheet"
      type="text/css"
    />
    
    <!-- Tailwind CSS via CDN. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'mono': [
                          'ui-monospace',
                          'SFMono-Regular',
                          'SF Mono',
                          'Monaco',
                          'Consolas',
                          'Liberation Mono',
                          'Courier New',
                          'monospace'
                        ]
                    }
                }
            }
        }
    </script>
    
    <style>
        /* Smooth scrolling for anchor links */
        html { scroll-behavior: smooth; }
        
        /* Custom scrollbar for webkit browsers */
        .custom-scrollbar::-webkit-scrollbar {
            height: 6px;
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
    </style>
</head>

<body class="bg-gray-100 min-h-screen">
    <!-- Header Section -->
    <%- include('./partials/header', { title, timestamp }) %>
    
    <!-- Navigation Menu (Sticky) -->
    <nav class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex space-x-8 overflow-x-auto py-4">
                <a href="#summary" class="text-blue-600 hover:text-blue-800 font-medium text-sm whitespace-nowrap transition-colors">Summary</a>
                <a href="#analytics" class="text-gray-500 hover:text-gray-700 font-medium text-sm whitespace-nowrap transition-colors">Analytics</a>
                <a href="#changes" class="text-gray-500 hover:text-gray-700 font-medium text-sm whitespace-nowrap transition-colors">Resource Changes</a>
                <div class="flex-1"></div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="space-y-8">
            <!-- Summary Statistics Section -->
            <section id="summary" class="scroll-mt-20">
                <%- include('./partials/resource-summary-stats', { summaryStats }) %>
            </section>

            <!-- Analytics Section -->
            <section id="analytics" class="scroll-mt-20">
                <%- include('./partials/resource-analytics', { summaryStats, rows }) %>
            </section>

            <!-- Resource Changes Table Section -->
            <section id="changes" class="scroll-mt-20">
                <%- include('./partials/resource-change-table', { rows }) %>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="text-center text-sm text-gray-500">
                <p>Generated by Octo • <%= timestamp %></p>
                <p class="mt-2">
                    <a href="#" onclick="scrollToTop(); return false;" class="text-blue-600 hover:text-blue-800 transition-colors">
                        ↑ Back to top
                    </a>
                </p>
            </div>
        </div>
    </footer>

    <script>
        // Smooth scroll to top
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Highlight active navigation item based on scroll position
        document.addEventListener('DOMContentLoaded', function() {
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('nav a[href^="#"]');
            
            function updateActiveNav() {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop - 100;
                    if (pageYOffset >= sectionTop) {
                        current = section.getAttribute('id');
                    }
                });

                navLinks.forEach(link => {
                    link.classList.remove('text-blue-600');
                    link.classList.add('text-gray-500');
                    if (link.getAttribute('href') === '#' + current) {
                        link.classList.remove('text-gray-500');
                        link.classList.add('text-blue-600');
                    }
                });
            }

            window.addEventListener('scroll', updateActiveNav);
            updateActiveNav(); // Call once on load
        });
    </script>
</body>

</html>
